package com.fitness.tracker.dao;import com.fitness.tracker.config.DatabaseConfig;import com.fitness.tracker.model.Client;import com.fitness.tracker.model.Coach;import java.sql.Connection;import java.sql.PreparedStatement;import java.sql.ResultSet;import java.sql.SQLException;public class CoachDAO {    public void registerCoach(Coach coach) throws SQLException {        String sql = "INSERT INTO Coach (username, password) VALUES (?, ?)";        try (Connection connection = DatabaseConfig.getConnection();             PreparedStatement preparedStatement = connection.prepareStatement(sql)) {            preparedStatement.setString(1, coach.getUsername());            preparedStatement.setString(2, coach.getPassword());            preparedStatement.executeUpdate();        }    }    public Coach loginCoach(String username, String password) throws SQLException {        String sql = "SELECT * FROM Coach WHERE username = ? AND password = ?";        try (Connection connection = DatabaseConfig.getConnection();             PreparedStatement preparedStatement = connection.prepareStatement(sql)) {            preparedStatement.setString(1, username);            preparedStatement.setString(2, password);            ResultSet resultSet = preparedStatement.executeQuery();            if (resultSet.next()) {                return new Coach(                        resultSet.getInt("coach_id"),                        resultSet.getString("username"),                        resultSet.getString("password")                );            } else {                throw new RuntimeException("Invalid credentials");            }        }    }    public void viewPrograms(int coachId) throws SQLException {        String sql = "SELECT program_id, program_name, description, min_age, max_age, min_weight, max_weight, min_height, max_height, min_bmi, max_bmi, price, duration_in_weeks, created_at FROM fitnessprogram WHERE coach_id = ?";        try (Connection connection = DatabaseConfig.getConnection();             PreparedStatement preparedStatement = connection.prepareStatement(sql)) {            preparedStatement.setInt(1, coachId);            ResultSet resultSet = preparedStatement.executeQuery();            while (resultSet.next()) {                int programId = resultSet.getInt("program_id");                String programName = resultSet.getString("program_name");                String description = resultSet.getString("description");                int minAge = resultSet.getInt("min_age");                int maxAge = resultSet.getInt("max_age");                double minWeight = resultSet.getDouble("min_weight");                double maxWeight = resultSet.getDouble("max_weight");                double minHeight = resultSet.getDouble("min_height");                double maxHeight = resultSet.getDouble("max_height");                double minBmi = resultSet.getDouble("min_bmi");                double maxBmi = resultSet.getDouble("max_bmi");                double price = resultSet.getDouble("price");                int duration = resultSet.getInt("duration_in_weeks");                String createdAt = resultSet.getString("created_at");                System.out.printf("| %d | %s | %s | %-3d - %-3d | %-4.1f - %-4.1f | %-3.2f - %-3.2f | %-4.2f - %-4.2f | %-5.2f | %d | %-16s |\n\n",                        programId, programName, description, minAge, maxAge, minWeight, maxWeight, minHeight, maxHeight, minBmi, maxBmi, price, duration, createdAt);            }        }    }    public void approveRequest(int coachId, int requestId) throws SQLException {        String sql = "UPDATE programapplication SET status = 'Approved' WHERE application_id = ? AND program_id IN (SELECT program_id FROM fitnessprogram WHERE coach_id = ?)";        try (Connection connection = DatabaseConfig.getConnection();             PreparedStatement preparedStatement = connection.prepareStatement(sql)) {            preparedStatement.setInt(1, requestId);            preparedStatement.setInt(2, coachId);            preparedStatement.executeUpdate();        }    }    public void viewAllRequests(int coachId) throws SQLException {        String sql = "SELECT * FROM programapplication WHERE program_id IN (SELECT program_id FROM fitnessprogram WHERE coach_id = ?)";        try (Connection connection = DatabaseConfig.getConnection();             PreparedStatement preparedStatement = connection.prepareStatement(sql)) {            preparedStatement.setInt(1, coachId);            ResultSet resultSet = preparedStatement.executeQuery();            while (resultSet.next()) {                System.out.println("Request ID: " + resultSet.getInt("application_id"));                System.out.println("Client ID: " + resultSet.getInt("client_id"));                System.out.println("Program ID: " + resultSet.getInt("program_id"));                System.out.println("Status: " + resultSet.getString("status"));                System.out.println("------------------------");            }        }    }    public void createProgram(int coachId, String name, String description, int minAge, int maxAge, double minWeight, double maxWeight, double minHeight, double maxHeight, double price, int duration) throws SQLException {        String sql = "INSERT INTO fitnessprogram (coach_id, program_name, description, min_age, max_age, min_weight, max_weight, min_height, max_height, min_bmi, max_bmi, price, duration_in_weeks, created_at) " +                "VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, CURRENT_TIMESTAMP)";        double minBmi = (minWeight / (minHeight * minHeight))*10000;        double maxBmi = (maxWeight / (maxHeight * maxHeight))*10000;        try (Connection connection = DatabaseConfig.getConnection();             PreparedStatement preparedStatement = connection.prepareStatement(sql)) {            preparedStatement.setInt(1, coachId);            preparedStatement.setString(2, name);            preparedStatement.setString(3, description);            preparedStatement.setInt(4, minAge);            preparedStatement.setInt(5, maxAge);            preparedStatement.setDouble(6, minWeight);            preparedStatement.setDouble(7, maxWeight);            preparedStatement.setDouble(8, minHeight);            preparedStatement.setDouble(9, maxHeight);            preparedStatement.setDouble(10, minBmi);            preparedStatement.setDouble(11, maxBmi);            preparedStatement.setDouble(12, price);            preparedStatement.setInt(13, duration);            preparedStatement.executeUpdate();        }    }}